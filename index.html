<!DOCTYPE html>
<html>
<head>
  <title>Job Application Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h2>ðŸŽ¯ Job Application Tracker</h2>
  <p>Total Goal: 600 jobs</p>

  <form id="jobForm">
    <input type="number" id="appliedToday" placeholder="Jobs applied today" required>
    <button type="submit">Submit</button>
  </form>

  <canvas id="progressChart" width="400" height="200"></canvas>

  <script>
  const API_URL = 'https://script.google.com/macros/s/AKfycbxWiz-_Koqs7kTfKge78a0jiQ6Cmcd95MjJhsI4YV4nNih6Vu7YKy7deSvbzR1n8GyC1w/exec';

  document.querySelector('form').addEventListener('submit', async function (e) {
    e.preventDefault();

    const value = parseInt(document.getElementById('appliedToday').value);
    if (!value || value < 1) return;

    try {
      const response = await fetch(`${API_URL}?appliedToday=${value}`);
      const data = await response.json();

      document.getElementById('applied').innerText = data.total;
      document.getElementById('remaining').innerText = data.remaining;

      const percent = (data.total / 600) * 100;
      const progressBar = document.getElementById('progress-bar');
      progressBar.style.width = percent + '%';
      progressBar.innerText = Math.floor(percent) + '%';
    } catch (err) {
      console.error('Error:', err);
    }
  });

  // Load current progress on page load
  window.onload = async () => {
    try {
      const response = await fetch(API_URL);
      const data = await response.json();

      document.getElementById('applied').innerText = data.total;
      document.getElementById('remaining').innerText = data.remaining;

      const percent = (data.total / 600) * 100;
      const progressBar = document.getElementById('progress-bar');
      progressBar.style.width = percent + '%';
      progressBar.innerText = Math.floor(percent) + '%';
    } catch (err) {
      console.error('Fetch on load failed:', err);
    }
  };
</script>
</body>
</html>
